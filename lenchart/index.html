<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./lengchart.css">
    <script src=https://dss1.bdstatic.com/5eN1bjq8AAUYm2zgoY3K/r/www/cache/static/protocol/https/jquery/jquery-1.10.2.min_65682a2.js></script>
    <script src="./lenchanrt.js"></script>
    <style type="text/css">
        /*加减号样式*/
        
        .orgWrap .content .plusMinus {
            position: absolute;
            bottom: 3px;
            left: 3px;
            cursor: pointer;
            top: auto;
        }
        
        ul,
        ol {
            margin-left: 21px;
        }
        /*第一层减号图标去掉*/
        
        .orgWrap .level1 i.plusMinus {
            display: none;
        }
        
        .level2s {
            position: relative;
            z-index: 2;
            background: #fff;
            margin: 0;
            padding: 0;
        }
        
        .level2s .level2 {
            position: relative;
            vertical-align: top;
            min-width: 215px;
        }
        /*新加的css*/
        /*组织样式*/
        
        .orgWrap .content.organization {
            background: #F3F3F3;
        }
        
        .orgWrap .content .numWrap {
            padding-left: 10px;
            background: #D9D9D9;
        }
        
        .orgWrap .content .numWrap>div {
            display: inline-block;
            width: 33.33%;
        }
        
        .orgWrap .content .name {
            height: 42px;
            line-height: 42px;
            font-weight: bold;
            border-bottom: 1px solid #B9DC93;
        }
        /*岗位样式*/
        
        .orgWrap .content.position {
            background: #C3D7E9;
        }
        
        .orgWrap .content .person {
            background: #E1EBF3;
        }
    </style>
</head>

<body>
    <div class="orgWrap"></div>
    <script>
        /**
                                                                                                                                                                                                var obj = {
                                                                                                                                                                                                    "name": "root",
                                                                                                                                                                                                    "children": [{
                                                                                                                                                                                                        "name": "1",
                                                                                                                                                                                                        "children": [{
                                                                                                                                                                                                            "name": "1-1"
                                                                                                                                                                                                        }, {
                                                                                                                                                                                                            "name": "1-2",
                                                                                                                                                                                                            "children": [{
                                                                                                                                                                                                                "name": "一段测试",
                                                                                                                                                                                                                "children": [{
                                                                                                                                                                                                                    "name": "asdasd"
                                                                                                                                                                                                                }, {
                                                                                                                                                                                                                    "name": "asdad",
                                                                                                                                                                                                                    "type": "tag"
                                                                                                                                                                                                                }, {
                                                                                                                                                                                                                    "name": "asda",
                                                                                                                                                                                                                    "children": [{
                                                                                                                                                                                                                        "name": "asdasd"
                                                                                                                                                                                                                    }, {
                                                                                                                                                                                                                        "name": "asdad",
                                                                                                                                                                                                                        "type": "tag"
                                                                                                                                                                                                                    }]
                                                                                                                                                                                                                }]
                                                                                                                                                                                                            }]
                                                                                                                                                                                                        }, {
                                                                                                                                                                                                            "name": "1-5",
                                                                                                                                                                                                            "type": "tag"
                                                                                                                                                                                                        }, {
                                                                                                                                                                                                            "name": "1-3"
                                                                                                                                                                                                        }, {
                                                                                                                                                                                                            "name": "1-4",
                                                                                                                                                                                                            "children": [{
                                                                                                                                                                                                                "name": "asda"
                                                                                                                                                                                                            }, {
                                                                                                                                                                                                                "name": "asdas"
                                                                                                                                                                                                            }]
                                                                                                                                                                                                        }, {
                                                                                                                                                                                                            "name": "1-5"
                                                                                                                                                                                                        }]
                                                                                                                                                                                                    }, {
                                                                                                                                                                                                        "name": "2",
                                                                                                                                                                                                        "children": [{
                                                                                                                                                                                                            "name": "asdad",
                                                                                                                                                                                                            "type": "tag"
                                                                                                                                                                                                        }, {
                                                                                                                                                                                                            "name": "2-1",
                                                                                                                                                                                                            "children": [{
                                                                                                                                                                                                                "name": "asd",
                                                                                                                                                                                                                "type": "tag"
                                                                                                                                                                                                            }, {
                                                                                                                                                                                                                "name": "fan",
                                                                                                                                                                                                                "children": [{
                                                                                                                                                                                                                    "name": "2-1-1",
                                                                                                                                                                                                                    "children": [{
                                                                                                                                                                                                                        "name": "2-1-1-0"
                                                                                                                                                                                                                    }]
                                                                                                                                                                                                                }]
                                                                                                                                                                                                            }]
                                                                                                                                                                                                        }, {
                                                                                                                                                                                                            "name": "2-2",
                                                                                                                                                                                                            "children": [{
                                                                                                                                                                                                                "name": "2-2-1"
                                                                                                                                                                                                            }, {
                                                                                                                                                                                                                "name": "2-2-2",
                                                                                                                                                                                                                "type": "tag"
                                                                                                                                                                                                            }]
                                                                                                                                                                                                        }]
                                                                                                                                                                                                    }, {
                                                                                                                                                                                                        "name": "3",
                                                                                                                                                                                                        "children": [{
                                                                                                                                                                                                            "name": "3-1",
                                                                                                                                                                                                            "children": [{
                                                                                                                                                                                                                "name": "2-4"
                                                                                                                                                                                                            }]
                                                                                                                                                                                                        }, {
                                                                                                                                                                                                            "name": "3-2"
                                                                                                                                                                                                        }, {
                                                                                                                                                                                                            "name": "tag",
                                                                                                                                                                                                            "type": "tag"
                                                                                                                                                                                                        }]
                                                                                                                                                                                                    }, {
                                                                                                                                                                                                        "name": "4",
                                                                                                                                                                                                        "children": [{
                                                                                                                                                                                                            "name": "测试",
                                                                                                                                                                                                            "type": "tag"
                                                                                                                                                                                                        }, {
                                                                                                                                                                                                            "name": "4-1",
                                                                                                                                                                                                            "children": [{
                                                                                                                                                                                                                "name": "tag",
                                                                                                                                                                                                                "type": "tag"
                                                                                                                                                                                                            }, {
                                                                                                                                                                                                                "name": "4-1-1"
                                                                                                                                                                                                            }, {
                                                                                                                                                                                                                "name": "4-1-2"
                                                                                                                                                                                                            }]
                                                                                                                                                                                                        }, {
                                                                                                                                                                                                            "name": "5-1-1-1",
                                                                                                                                                                                                            "children": [{
                                                                                                                                                                                                                "name": "adasd"
                                                                                                                                                                                                            }, {
                                                                                                                                                                                                                "name": "zui",
                                                                                                                                                                                                                "type": "tag"
                                                                                                                                                                                                            }]
                                                                                                                                                                                                        }]
                                                                                                                                                                                                    }, {
                                                                                                                                                                                                        "name": "5",
                                                                                                                                                                                                        "children": [{
                                                                                                                                                                                                            "name": "5-1",
                                                                                                                                                                                                            "children": [{
                                                                                                                                                                                                                "name": "5-1-1",
                                                                                                                                                                                                                "children": [{
                                                                                                                                                                                                                    "name": "zda",
                                                                                                                                                                                                                    "type": "tag"
                                                                                                                                                                                                                }, {
                                                                                                                                                                                                                    "name": "4-2",
                                                                                                                                                                                                                    "children": ""
                                                                                                                                                                                                                }]
                                                                                                                                                                                                            }, {
                                                                                                                                                                                                                "name": "z",
                                                                                                                                                                                                                "type": "tag"
                                                                                                                                                                                                            }]
                                                                                                                                                                                                        }]
                                                                                                                                                                                                    }, {
                                                                                                                                                                                                        "name": "6",
                                                                                                                                                                                                        "type": "tag"
                                                                                                                                                                                                    }]
                                                                                                                                                                                                };
                                                                                                                                                                                                $('.orgWrap').lenChart({
                                                                                                                                                                                                    data: obj, //数据源
                                                                                                                                                                                                    drag: true, //是否可拖拽
                                                                                                                                                                                                    depth: 3, //初始化展示的层级
                                                                                                                                                                                                    renderdata: function(data, $dom) {
                                                                                                                                                                                                        console.log(data)
                                                                                                                                                                                                    }, //根据数据定制每个名片里面的DOM结构
                                                                                                                                                                                                    callback: function() {} //渲染完图表后的回调函数    
                                                                                                                                                                                                })
                                                                                                                                                                                                **/
    </script>
    <script type="text/javascript">
        $(function() {
            var obj = {
                id: 001,
                zname: 'fanjiantoa',
                data: {
                    name: '特区建发',
                    plait: 20,
                    onduty: 10,
                    type: "organization",
                    Type: '1',
                },
                children: [{
                    id: 001,
                    data: {
                        name: '总经理',
                        person: '陈志明',
                        type: "position",
                        // Type: '1',
                    },
                    children: [{
                        id: 001,
                        data: {
                            name: '特区建发',
                            plait: 20,
                            onduty: 10,
                            type: "organization",
                            Type: '1',
                        },
                        children: [

                        ]
                    }, {
                        id: 001,
                        data: {
                            name: '特区建发',
                            plait: 20,
                            onduty: 10,
                            type: "organization",

                        },
                        children: [

                        ]
                    }, ]
                }, {
                    id: 001,
                    data: {
                        name: 'zasd中文建设',
                        plait: 20,
                        onduty: 10,
                        type: "organization"
                    },
                    children: [{
                        id: 001,
                        data: {
                            name: '特区建发',
                            plait: 20,
                            onduty: 10,
                            type: "organization"
                        },
                        children: [{
                            id: 001,
                            data: {
                                name: '特区建发',
                                plait: 20,
                                onduty: 10,
                                type: "organization"
                            },
                            children: [

                            ]
                        }, {
                            id: 001,
                            data: {
                                name: '特区建发',
                                plait: 20,
                                onduty: 10,
                                type: "organization"
                            },
                            children: [

                            ]
                        }, ]
                    }, {
                        id: 001,
                        data: {
                            name: '特区建发',
                            plait: 20,
                            onduty: 10,
                            type: "organization"
                        },
                        children: [{
                            id: 001,
                            data: {
                                name: '特区建发',
                                plait: 20,
                                onduty: 10,
                                type: "organization"
                            },
                            children: [

                            ]
                        }, {
                            id: 001,
                            data: {
                                name: '特区建发',
                                plait: 20,
                                onduty: 10,
                                type: "organization"
                            },
                            children: [

                            ]
                        }, ]
                    }]
                }, {
                    id: 001,
                    data: {
                        name: '特区建发',
                        plait: 20,
                        onduty: 10,
                        type: "organization"
                    },
                    children: [{
                        id: 001,
                        data: {
                            name: '特区建发',
                            plait: 20,
                            onduty: 10,
                            type: "organization"
                        },
                        children: [

                        ]
                    }, ]
                }, ]
            }

            $('.orgWrap').lenChart({
                data: obj,
                drag: true,
                renderdata: function(data, $dom) {

                    var value = data.data;
                    if (value && Object.keys(value).length) {
                        console.log(value)
                        var $name = $('<div class="name"></div>');
                        (value.name) && $name.text(value.name);
                        $dom.append($name)
                            //组织
                        if (value.type && value.type === 'organization') {
                            //编制 
                            var $plait = $('<div><span>编制:</span><span class="num"></span></div>');
                            (value.plait) && $plait.find('.num').text(value.plait)
                                //在职    
                            var $onduty = $('<div><span>在职:</span><span class="num"></span></div>');
                            (value.onduty) && $onduty.find('.num').text(value.onduty)
                                //缺编
                            var $short = $('<div><span>缺编:</span><span class="num"></span></div>')
                            if (value.plait && value.onduty) {
                                $short.find('.num').text(value.plait - value.onduty)
                            }
                            var $wrap = $('<div class="numWrap"></div>')
                            $wrap.append($plait, $onduty, $short);
                            $dom.addClass('organization')
                            $dom.append($wrap)
                        } else {
                            //岗位
                            var $person = $('<div class="person"></div>');
                            !!(value.person) && $person.text(value.person)
                            $dom.addClass('position')
                            $dom.append($person)
                        }
                        var icon = '<i class="icon plusMinus icon-minus-sign"></i>';
                        var $icon = $(icon);
                        if (data.children && data.children.length) {
                            $dom.append($icon);
                        }

                    }
                },
                callback: function() {}
            })

        })
    </script>
</body>

</html>